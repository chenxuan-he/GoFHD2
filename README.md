# Code for "A Goodness-of-Fit Assessment for General Learning Procedures in High Dimensions"

This repository contains the code for the submitted article *A Goodness-of-Fit Assessment for General Learning Procedures in High Dimensions*. 
Below, you will find detailed explanations of the scripts and their outputs.
Intermediate result files are not included to save space.

---

## Motivating Example
This section includes the code for the motivating example presented in the introduction.

Scripts:
- **motivatingExample.R**: 
  - Generates results for Table 1 in the introduction section.
  - Run `Rscript motivatingExample.R` in the terminal. Results will be stored in the `results` folder.
- **motivatingExampleRes.R**:
  - Reads the results generated by `motivatingExample.R`.
  - Run `Rscript motivatingExampleRes.R` in the terminal. Outputs will be written to a `.csv` file.

---

## Simulations

### Model 1
- Compares two parametric goodness-of-fit tests:
  - Fan, J. & Huang, L.-S. *Goodness-of-fit tests for parametric regression models*. *Journal of the American Statistical Association*, 96, 640–652 (2001).
  - Shah, R. D. & Bühlmann, P. *Goodness-of-fit tests for high-dimensional linear models*. *Journal of the Royal Statistical Society: Series B*, 80, 113–135 (2018).

Scripts:
- **model1.R**: Main code for Model 1.
- **model1.sh**: Runs various settings in *model1.R* sequentially.
  - Run `bash model1.sh` in the terminal. Results are saved as `.txt` files.
- **model1_plot.R**: Plots the results using `ggplot2`.

### Models 2-4
- Evaluates the goodness-of-fit for various regression methods (LASSO, SCAD, SVR, XGBOOST, RF, FNN).

Scripts:
- **model234.R**: Main code for Models 2-4.
- **model234.sh**: Runs various settings in *model234.R* sequentially.
  - Run `bash model234.sh` to save results in the `results` folder.
- **model234_plot.R**: Plots the results using `ggplot2`.

### Model 5
- Evaluates goodness-of-fit for binary data, comparing with:
  - Zhang, J., Ding, J., & Yang, Y. *Is a classification procedure good enough? A goodness-of-fit assessment tool for classification learning*. *Journal of the American Statistical Association*, 118, 1115–1125 (2023).
  - Javanmard, A., & Mehrabi, M. *GRASP: A goodness-of-fit test for classification learning*. *Journal of the Royal Statistical Society: Series B*, 86, 215–245 (2024).

Scripts:
- **model5.R**: Main code for Model 5.
- **model5.sh**: Runs various settings in Model 5 sequentially.
  - Run `bash model5.sh` to save results as `.txt` files.
- **model5_plot.R**: Plots the results using `ggplot2`.

---

## Real-Data Examples

### Cortisol Stress Reactivity Dataset
- **real_data_cortisol/**: Folder that contains the data of the real data *Cortisol Stress Reactivity Dataset*, and a preprocessing file *utils_mediation.R* from the paper *Guo, X., Li, R., Liu, J. & Zeng, M. High-dimensional mediation analysis for selecting DNA methylation loci mediating childhood trauma and cortisol stress reactivity. Journal of the American Statistical Association 117, 1110–1121 (2022).*
- **real_data_cortisol.R**: 
  - Run `Rscript real_data_cortisol.R` to generate testing results and mean squared errors (MSEs) for several regression methods.

### Wine Quality Dataset
- **real_data_wine/**: Folder that contains the data of the real data *Wine Quality Dataset*.
- **real_data_wine.R**: 
  - Run `Rscript real_data_wine.R` to generate testing results for various regression methods.
- **real_data_wine.sh**: Executes scripts for MSE computations.
- **real_data_wine_res.R, real_data_wine_mse.R**:
  - Example: Run `bash real_data_wine.sh` to compute MSEs, and `Rscript real_data_wine_res.R` to save the results as `real_data_wine.csv`.

### MNIST Classification Task
- Compares with:
  - Zhang, J., Ding, J., & Yang, Y. *A goodness-of-fit assessment tool for classification learning*. *Journal of the American Statistical Association*, 118, 1115–1125 (2023).
  - Javanmard, A., & Mehrabi, M. *GRASP: A goodness-of-fit test for classification learning*. *Journal of the Royal Statistical Society: Series B*, 86, 215–245 (2024).

Scripts:
- **real_data_mnist_pre.R**: Preprocesses MNIST data (e.g., selecting digits '4' and '9', sampling 1000 examples, and saving as `real_data_mnist.RData`).
- **real_data_mnist.R**: Runs goodness-of-fit tests and computes $p$-values.
- **real_data_mnist_accuracy.R, real_data_mnist.sh**: 
  - Run `bash real_data_mnist.sh` to compute prediction accuracy for classification tasks.
- **real_data_mnist_res.R**: Reads and stores results in a `.csv` file.

---

## Other Files
Two folders:
- **plots/**: Folder that contains results generated by *model1_plot.R*, *model234_plot.R*, and *model5_plot.R*.
- **results/**: Folder that contains intermediate files generated by our codes.

Other scripts:
- **push.sh** and **pull.sh**: Files that push and pull files from the GitHub.
- **functions.R**: File that contains all necessary functions defined for our numerical studies.
